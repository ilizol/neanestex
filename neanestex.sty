
\ProvidesPackage{neanestex}

\RequirePackage{xcolor}
\RequirePackage{luacode}
\RequirePackage{luacolor}
\RequirePackage{fontspec}
\RequireLuaTeX

\newfontfamily\byzneumefont{Neanes}
\newfontfamily\byzlyricfont{Source Serif 4}
\newfontfamily\byzdropcapfont{Source Serif 4}
\newfontfamily\byztextboxfont{Source Serif 4}

\begin{luacode*}
    dofile("neanestex.lua")
\end{luacode*}

% Font sizes
\newlength{\byzneumesize}
\setlength{\byzneumesize}{20bp}

\newlength{\byzmodekeysize}
\setlength{\byzmodekeysize}{20bp}

\newlength{\byzlyricsize}
\setlength{\byzlyricsize}{12bp}

\newlength{\byzdropcapsize}
\setlength{\byzdropcapsize}{60bp}

\newlength{\byztextboxsize}
\setlength{\byztextboxsize}{20bp}

% Colors
\definecolor{byzcoloraccidental}{HTML}{ED0000}
\definecolor{byzcolordropcap}{HTML}{ED0000}
\definecolor{byzcolorfthora}{HTML}{ED0000}
\definecolor{byzcolorgorgon}{HTML}{ED0000}
\definecolor{byzcolorheteron}{HTML}{ED0000}
\definecolor{byzcolorison}{HTML}{ED0000}
\definecolor{byzcolorkoronis}{HTML}{ED0000}
\definecolor{byzcolorlyrics}{HTML}{000000}
\definecolor{byzcolormartyria}{HTML}{ED0000}
\definecolor{byzcolormeasurebar}{HTML}{ED0000}
\definecolor{byzcolormeasurenumber}{HTML}{000000}
\definecolor{byzcolormodekey}{HTML}{ED0000}
\definecolor{byzcolorneume}{HTML}{000000}
\definecolor{byzcolornoteindicator}{HTML}{ED0000}
\definecolor{byzcolortempo}{HTML}{ED0000}
\definecolor{byzcolortextbox}{HTML}{000000}

% \byzneume
% #1 optional color
% #2 required hex unicode value
% Example usage:
% \byzneume[E000] prints an ison in the default color and size
\newcommand{\byzneume}[2][000000]{%
\textcolor[HTML]{#1}{%
\fontsize{\byzneumesize}{\baselineskip}%
\byzneumefont%
\char"#2}%
}

% Command to draw a full score at the macro insertion point
\newcommand{\neanesscore}[1]{%
    \directlua{neanestex.include_score("#1")}
}
